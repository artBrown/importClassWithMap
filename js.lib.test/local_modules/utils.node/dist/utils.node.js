"use strict";var _serializers=_interopRequireDefault(require("serializers"));function _interopRequireDefault(e){return e&&e.__esModule?e:{default:e}}function asyncGeneratorStep(e,r,n,t,a,i,o){try{var u=e[i](o),s=u.value}catch(e){return void n(e)}u.done?r(s):Promise.resolve(s).then(t,a)}function _asyncToGenerator(e){return function(){var r=this,n=arguments;return new Promise((function(t,a){var i=e.apply(r,n);function o(e){asyncGeneratorStep(i,t,a,o,u,"next",e)}function u(e){asyncGeneratorStep(i,t,a,o,u,"throw",e)}o(void 0)}))}}function _classCallCheck(e,r){if(!(e instanceof r))throw new TypeError("Cannot call a class as a function")}function _defineProperties(e,r){for(var n=0;n<r.length;n++){var t=r[n];t.enumerable=t.enumerable||!1,t.configurable=!0,"value"in t&&(t.writable=!0),Object.defineProperty(e,t.key,t)}}function _createClass(e,r,n){return r&&_defineProperties(e.prototype,r),n&&_defineProperties(e,n),e}function _defineProperty(e,r,n){return r in e?Object.defineProperty(e,r,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[r]=n,e}var BT=function(){var e,r;return r=e=function(){function e(){var r=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;_classCallCheck(this,e),this._nd=new BT.Nd(r)}var r,n;return _createClass(e,[{key:"appendEntryInNodeTree",value:function(e,r){return void 0===e&&(this._nd=this.appendEntryInNodeTree(this._nd,r)),null===e?e=new BT.Nd(r):e._e<=r?e._r=this.appendEntryInNodeTree(e._r,r):e._l=this.appendEntryInNodeTree(e._l,r),e}},{key:"rakeEntryNodeInTree",value:function(e,r){return void 0===r?this.rakeEntryNodeInTree(e,0):(null===e||(null!==e._r&&this.rakeEntryNodeInTree(e._r,r+1),null!==e._l&&this.rakeEntryNodeInTree(e._l,r+1),console.log(this.genIndentSpaces(r)+""+e._e)),null)}},{key:"propagateSeedMethod",value:function(e,r,n){n===BT._u&&this.appendEntryInNodeTree(e,r),(r<0&&n===BT._a||0<r&&n===BT._d)&&(this.appendEntryInNodeTree(e,r),n===BT._a?r++:r--,this.propagateSeedMethod(e,r,n))}},{key:"genIndentSpaces",value:function(e){for(var r="";0!=e--;)r+=" ";return r}},{key:"writeBinaryTree",value:(n=_asyncToGenerator(regeneratorRuntime.mark((function e(r,n,t){var a;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a=this.writeBinaryTreeNode(r,""),e.prev=1,e.next=4,_serializers.default.writeStringToFile(a,n,t);case 4:e.next=9;break;case 6:e.prev=6,e.t0=e.catch(1),console.log(e.t0);case 9:case"end":return e.stop()}}),e,this,[[1,6]])}))),function(e,r,t){return n.apply(this,arguments)})},{key:"writeBinaryTreeNode",value:function(e,r){return null===e?r+="# ":(r+=e._e.toString()+" ",r=this.writeBinaryTreeNode(e._l,r),r=this.writeBinaryTreeNode(e._r,r)),r}},{key:"readBinaryTree",value:(r=_asyncToGenerator(regeneratorRuntime.mark((function e(r,n,t){var a,i,o,u,s,l;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a=[],e.prev=1,e.next=4,_serializers.default.readStringFmFile(a,n,t);case 4:e.next=9;break;case 6:e.prev=6,e.t0=e.catch(1),console.log(e.t0);case 9:return i=a[0],o=i?i.match(/(?:\d+|#)\s/g):void 0,u=[],o&&o.forEach((function(e){return u.push(e)})),s=_serializers.default.makeIterator(u),l=new RegExp(/-?[0-9]*\.?[0-9]+\s/g),r=this.readBinaryTreeNode(r,s,l),e.abrupt("return",r);case 17:case"end":return e.stop()}}),e,this,[[1,6]])}))),function(e,n,t){return r.apply(this,arguments)})},{key:"readBinaryTreeNode",value:function(e,r,n){if(!r.hasNext())return e;var t,a=r.next();return a.match(n)?(t=parseInt(a.trim()),(e=new BT.Nd(t))._l=this.readBinaryTreeNode(e._l,r,n),e._r=this.readBinaryTreeNode(e._r,r,n),e):e}}]),e}(),_defineProperty(e,"_a",1),_defineProperty(e,"_d",-1),_defineProperty(e,"_u",0),_defineProperty(e,"Nd",function(){return function e(r){_classCallCheck(this,e),this._l=null,this._r=null,this._e=r}}()),r}();module.exports={BinaryTree:BT};
//# sourceMappingURL=data:application/json;charset=utf8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbInV0aWxzLm5vZGUuanMiXSwibmFtZXMiOlsiX3NlcmlhbGl6ZXJzIiwiX2ludGVyb3BSZXF1aXJlRGVmYXVsdCIsInJlcXVpcmUiLCJvYmoiLCJfX2VzTW9kdWxlIiwiZGVmYXVsdCIsImFzeW5jR2VuZXJhdG9yU3RlcCIsImdlbiIsInJlc29sdmUiLCJyZWplY3QiLCJfbmV4dCIsIl90aHJvdyIsImtleSIsImFyZyIsImluZm8iLCJ2YWx1ZSIsImVycm9yIiwiZG9uZSIsIlByb21pc2UiLCJ0aGVuIiwiX2FzeW5jVG9HZW5lcmF0b3IiLCJmbiIsInNlbGYiLCJ0aGlzIiwiYXJncyIsImFyZ3VtZW50cyIsImFwcGx5IiwiZXJyIiwidW5kZWZpbmVkIiwiX2NsYXNzQ2FsbENoZWNrIiwiaW5zdGFuY2UiLCJDb25zdHJ1Y3RvciIsIlR5cGVFcnJvciIsIl9kZWZpbmVQcm9wZXJ0aWVzIiwidGFyZ2V0IiwicHJvcHMiLCJpIiwibGVuZ3RoIiwiZGVzY3JpcHRvciIsImVudW1lcmFibGUiLCJjb25maWd1cmFibGUiLCJ3cml0YWJsZSIsIk9iamVjdCIsImRlZmluZVByb3BlcnR5IiwiX2NyZWF0ZUNsYXNzIiwicHJvdG9Qcm9wcyIsInN0YXRpY1Byb3BzIiwicHJvdG90eXBlIiwiX2RlZmluZVByb3BlcnR5IiwiQlQiLCJfY2xhc3MiLCJfdGVtcCIsImUiLCJfbmQiLCJOZCIsIl9yZWFkQmluYXJ5VHJlZSIsIl93cml0ZUJpbmFyeVRyZWUiLCJuZCIsImFwcGVuZEVudHJ5SW5Ob2RlVHJlZSIsIl9lIiwiX3IiLCJfbCIsImQiLCJyYWtlRW50cnlOb2RlSW5UcmVlIiwiY29uc29sZSIsImxvZyIsImdlbkluZGVudFNwYWNlcyIsInNkIiwiYXNjRHNjIiwiX3UiLCJfYSIsIl9kIiwicHJvcGFnYXRlU2VlZE1ldGhvZCIsInJlZ2VuZXJhdG9yUnVudGltZSIsIm1hcmsiLCJfY2FsbGVlIiwiYmFzZSIsInNlcmQiLCJzIiwid3JhcCIsIl9jb250ZXh0IiwicHJldiIsIm5leHQiLCJ3cml0ZUJpbmFyeVRyZWVOb2RlIiwid3JpdGVTdHJpbmdUb0ZpbGUiLCJ0MCIsInN0b3AiLCJfeCIsIl94MiIsIl94MyIsInRvU3RyaW5nIiwiX2NhbGxlZTIiLCJzcG9uIiwiYWxGbGF0IiwiZmxhdCIsIm0iLCJ0aWNrIiwidGkiLCJyZyIsIl9jb250ZXh0MiIsInJlYWRTdHJpbmdGbUZpbGUiLCJtYXRjaCIsImZvckVhY2giLCJwdXNoIiwibWFrZUl0ZXJhdG9yIiwiUmVnRXhwIiwicmVhZEJpbmFyeVRyZWVOb2RlIiwiYWJydXB0IiwiX3g0IiwiX3g1IiwiX3g2IiwiaGFzTmV4dCIsImNoYWQiLCJwYXJzZUludCIsInRyaW0iLCJfY2xhc3MyIiwibW9kdWxlIiwiZXhwb3J0cyIsIkJpbmFyeVRyZWUiXSwibWFwcGluZ3MiOiJBQUFBLGFBRUEsSUFBSUEsYUFBZUMsdUJBQXVCQyxRQUFRLGdCQUVsRCxTQUFTRCx1QkFBdUJFLEdBQU8sT0FBT0EsR0FBT0EsRUFBSUMsV0FBYUQsRUFBTSxDQUFFRSxRQUFXRixHQUV6RixTQUFTRyxtQkFBbUJDLEVBQUtDLEVBQVNDLEVBQVFDLEVBQU9DLEVBQVFDLEVBQUtDLEdBQU8sSUFBTSxJQUFJQyxFQUFPUCxFQUFJSyxHQUFLQyxHQUFVRSxFQUFRRCxFQUFLQyxNQUFTLE1BQU9DLEdBQXdCLFlBQWZQLEVBQU9PLEdBQXNCRixFQUFLRyxLQUFRVCxFQUFRTyxHQUFpQkcsUUFBUVYsUUFBUU8sR0FBT0ksS0FBS1QsRUFBT0MsR0FFN1AsU0FBU1Msa0JBQWtCQyxHQUFNLE9BQU8sV0FBYyxJQUFJQyxFQUFPQyxLQUFNQyxFQUFPQyxVQUFXLE9BQU8sSUFBSVAsU0FBUSxTQUFVVixFQUFTQyxHQUFVLElBQUlGLEVBQU1jLEVBQUdLLE1BQU1KLEVBQU1FLEdBQU8sU0FBU2QsRUFBTUssR0FBU1QsbUJBQW1CQyxFQUFLQyxFQUFTQyxFQUFRQyxFQUFPQyxFQUFRLE9BQVFJLEdBQVUsU0FBU0osRUFBT2dCLEdBQU9yQixtQkFBbUJDLEVBQUtDLEVBQVND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QyxFQTVLNEIsR0E2S2hDRixnQkFBZ0JFLEVBQVEsS0FBTSxHQUFJRixnQkFBZ0JFLEVBQVEsTUFBTyxHQUFJRixnQkFBZ0JFLEVBQVEsS0FBTSxHQUFJRixnQkFBZ0JFLEVBQVEsS0FBbUIsV0FTckosT0FSQSxTQUFTaUUsRUFBUS9ELEdBQ2Z2QixnQkFBZ0JOLEtBQU00RixHQUV0QjVGLEtBQUtzQyxHQUFLLEtBQ1Z0QyxLQUFLcUMsR0FBSyxLQUNWckMsS0FBS29DLEdBQUtQLEdBTnlJLElBVWpKRCxFQTFMQyxHQTZMVGlFLE9BQU9DLFFBQVUsQ0FDZkMsV0FBWXJFIiwiZmlsZSI6InV0aWxzLm5vZGUuanMiLCJzb3VyY2VzQ29udGVudCI6WyIvKlxuKiAgIHV0aWxzLm5vZGUuanNcbiogICAgICAgICAgICAgICAgICAgICAgICAgICAvLyBuZWVkIHRlc3RzIG9uIG1ldGhvZHMuXG4qXG4qICAgQXJ0IEJyb3duLCBhcnQuYnJvd25AcXV0ZXQuY29tXG4qL1xuaW1wb3J0IHNlcmlhbGl6ZXJzIGZyb20gXCJzZXJpYWxpemVyc1wiO1xuY29uc3QgQlQgPSAoKCkgPT4ge1xuICByZXR1cm4gY2xhc3Mge1xuICAgIHN0YXRpYyBfYSA9IDE7XG4gICAgc3RhdGljIF9kID0gLTE7XG4gICAgc3RhdGljIF91ID0gMDtcbiAgICBjb25zdHJ1Y3RvcihlID0gbnVsbCkge1xuICAgICAgdGhpcy5fbmQgPSBuZXcgQlQuTmQoZSk7XG4gICAgfVxuICAgIHN0YXRpYyBOZCA9IGNsYXNzIHtcbiAgICAgIGNvbnN0cnVjdG9yKGUpIHtcbiAgICAgICAgdGhpcy5fbCA9IG51bGw7XG4gICAgICAgIHRoaXMuX3IgPSBudWxsO1xuICAgICAgICB0aGlzLl9lID0gZTtcbiAgICAgIH1cbiAgICB9O1xuICAgIGFwcGVuZEVudHJ5SW5Ob2RlVHJlZShuZCwgZSkge1xuICAgICAgaWYgKG5kID09PSB1bmRlZmluZWQpXG4gICAgICAgIHRoaXMuX25kID0gdGhpcy5hcHBlbmRFbnRyeUluTm9kZVRyZWUodGhpcy5fbmQsIGUpO1xuICAgICAgaWYgKG5kID09PSBudWxsKSB7XG4gICAgICAgIG5kID0gbmV3IEJULk5kKGUpO1xuICAgICAgfSBlbHNlIHtcbiAgICAgICAgaWYgKG5kLl9lIDw9IGUpIHtcbiAgICAgICAgICBuZC5fciA9IHRoaXMuYXBwZW5kRW50cnlJbk5vZGVUcmVlKG5kLl9yLCBlKTtcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICBuZC5fbCA9IHRoaXMuYXBwZW5kRW50cnlJbk5vZGVUcmVlKG5kLl9sLCBlKTtcbiAgICAgICAgfVxuICAgICAgfVxuICAgICAgcmV0dXJuIG5kO1xuICAgIH1cbiAgICByYWtlRW50cnlOb2RlSW5UcmVlKG5kLCBkKSB7XG4gICAgICBpZiAoZCA9PT0gdW5kZWZpbmVkKVxuICAgICAgICByZXR1cm4gdGhpcy5yYWtlRW50cnlOb2RlSW5UcmVlKG5kLCAwKTtcbiAgICAgIGVsc2UgaWYgKG5kID09PSBudWxsKVxuICAgICAgICByZXR1cm4gbnVsbDtcbiAgICAgIGVsc2Uge1xuICAgICAgICBpZiAobmQuX3IgIT09IG51bGwpXG4gICAgICAgICAgdGhpcy5yYWtlRW50cnlOb2RlSW5UcmVlKG5kLl9yLCBkICsgMSk7XG4gICAgICAgIGlmIChuZC5fbCAhPT0gbnVsbClcbiAgICAgICAgICB0aGlzLnJha2VFbnRyeU5vZGVJblRyZWUobmQuX2wsIGQgKyAxKTtcbiAgICAgICAgY29uc29sZS5sb2codGhpcy5nZW5JbmRlbnRTcGFjZXMoZCkgKyAnJyArIG5kLl9lKTtcbiAgICAgIH1cbiAgICAgIHJldHVybiBudWxsO1xuICAgIH1cbiAgICBwcm9wYWdhdGVTZWVkTWV0aG9kKG5kLCBzZCwgYXNjRHNjKSB7XG4gICAgICBpZiAoYXNjRHNjID09PSBCVC5fdSlcbiAgICAgICAgdGhpcy5hcHBlbmRFbnRyeUluTm9kZVRyZWUobmQsIHNkKTtcbiAgICAgIGlmIChzZCA8IDAgJiYgYXNjRHNjID09PSBCVC5fYSB8fCAwIDwgc2QgJiYgYXNjRHNjID09PSBCVC5fZCkge1xuICAgICAgICB0aGlzLmFwcGVuZEVudHJ5SW5Ob2RlVHJlZShuZCwgc2QpO1xuICAgICAgICBpZiAoYXNjRHNjID09PSBCVC5fYSkgc2QrKzsgZWxzZSBzZC0tO1xuICAgICAgICB0aGlzLnByb3BhZ2F0ZVNlZWRNZXRob2QobmQsIHNkLCBhc2NEc2MpO1xuICAgICAgfVxuICAgIH1cbiAgICBnZW5JbmRlbnRTcGFjZXMoZCkge1xuICAgICAgbGV0IGkgPSBcIlwiO1xuICAgICAgd2hpbGUgKGQtLSAhPT0gMCkgaSArPSBcIiBcIjtcbiAgICAgIHJldHVybiBpO1xuICAgIH1cbiAgICBhc3luYyB3cml0ZUJpbmFyeVRyZWUobmQsIGJhc2UsIHNlcmQpIHtcbiAgICAgIGNvbnN0IHMgPSB0aGlzLndyaXRlQmluYXJ5VHJlZU5vZGUobmQsIFwiXCIpO1xuICAgICAgdHJ5IHtcbiAgICAgICAgYXdhaXQgc2VyaWFsaXplcnMud3JpdGVTdHJpbmdUb0ZpbGUocywgYmFzZSwgc2VyZCk7XG4gICAgICB9IGNhdGNoIChlKSB7XG4gICAgICAgIGNvbnNvbGUubG9nKGUpO1xuICAgICAgfVxuICAgIH1cbiAgICB3cml0ZUJpbmFyeVRyZWVOb2RlKG5kLCBzKSB7XG4gICAgICBpZiAobmQgPT09IG51bGwpIHtcbiAgICAgICAgcyArPSBcIiMgXCI7XG4gICAgICB9IGVsc2Uge1xuICAgICAgICBzICs9IG5kLl9lLnRvU3RyaW5nKCkgKyBcIiBcIjtcbiAgICAgICAgcyA9IHRoaXMud3JpdGVCaW5hcnlUcmVlTm9kZShuZC5fbCwgcyk7XG4gICAgICAgIHMgPSB0aGlzLndyaXRlQmluYXJ5VHJlZU5vZGUobmQuX3IsIHMpO1xuICAgICAgfVxuICAgICAgcmV0dXJuIHM7XG4gICAgfVxuICAgIGFzeW5jIHJlYWRCaW5hcnlUcmVlKHNwb24sIGJhc2UsIHNlcmQpIHtcbiAgICAgIGNvbnN0IGFsRmxhdCA9IFtdO1xuICAgICAgdHJ5IHtcbiAgICAgICAgYXdhaXQgc2VyaWFsaXplcnMucmVhZFN0cmluZ0ZtRmlsZShhbEZsYXQsIGJhc2UsIHNlcmQpO1xuICAgICAgfSBjYXRjaCAoZSkge1xuICAgICAgICBjb25zb2xlLmxvZyhlKTtcbiAgICAgIH1cbiAgICAgIGNvbnN0IGZsYXQgPSBhbEZsYXRbMF07XG4gICAgICBjb25zdCBtID0gZmxhdCA/IGZsYXQubWF0Y2goLyg/OlxcZCt8IylcXHMvZykgOiB1bmRlZmluZWQ7XG4gICAgICBjb25zdCB0aWNrID0gW107XG4gICAgICBpZiAobSlcbiAgICAgICAgbS5mb3JFYWNoKGUgPT4gdGljay5wdXNoKGUpKTtcbiAgICAgIGNvbnN0IHRpID0gc2VyaWFsaXplcnMubWFrZUl0ZXJhdG9yKHRpY2spO1xuICAgICAgY29uc3QgcmcgPSBuZXcgUmVnRXhwKC8tP1swLTldKlxcLj9bMC05XStcXHMvZyk7XG4gICAgICBzcG9uID0gdGhpcy5yZWFkQmluYXJ5VHJlZU5vZGUoc3BvbiwgdGksIHJnKTtcbiAgICAgIHJldHVybiBzcG9uO1xuICAgIH1cbiAgICByZWFkQmluYXJ5VHJlZU5vZGUoc3BvbiwgdGksIHJnKSB7XG4gICAgICBpZiAoIXRpLmhhc05leHQoKSkgcmV0dXJuIHNwb247XG4gICAgICBjb25zdCBjaGFkID0gdGkubmV4dCgpO1xuICAgICAgY29uc3QgbSA9IGNoYWQubWF0Y2gocmcpO1xuICAgICAgbGV0IGU7XG4gICAgICBpZiAobSlcbiAgICAgICAgZSA9IHBhcnNlSW50KGNoYWQudHJpbSgpKTtcbiAgICAgIGVsc2UgcmV0dXJuIHNwb247XG4gICAgICBzcG9uID0gbmV3IEJULk5kKGUpO1xuICAgICAgc3Bvbi5fbCA9IHRoaXMucmVhZEJpbmFyeVRyZWVOb2RlKHNwb24uX2wsIHRpLCByZyk7XG4gICAgICBzcG9uLl9yID0gdGhpcy5yZWFkQmluYXJ5VHJlZU5vZGUoc3Bvbi5fciwgdGksIHJnKTtcbiAgICAgIHJldHVybiBzcG9uO1xuICAgIH1cbiAgfTtcbn0pKCk7XG5tb2R1bGUuZXhwb3J0cyA9IHtcbiAgQmluYXJ5VHJlZTogQlQsXG59O1xuIl19
